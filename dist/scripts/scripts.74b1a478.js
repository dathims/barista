"use strict";function HomeCtrl(a,b,c){var d=this;d.list=[],c.getRessources().then(function(a){var b=a.data.feed.entry;_.forEach(b,function(a){function b(a){return a.split("/values/")[1]}d.list.push({ressource:b(a.id.$t),title:a.gsx$title.$t,img:a.gsx$img.$t,type:a.gsx$type.$t,director:a.gsx$director.$t,description:a.gsx$description.$t,trailer:a.gsx$trailer.$t,link:a.gsx$link.$t,category:a.gsx$category.$t,episode:a.gsx$episode.$t})}),c.save(d.list).then(function(a){c.storage=a,console.log(c.storage)})["catch"](function(a){console.error(a)})},function(a){b.error("error",a)})}function drive(a,b,c){function d(){return a.get(g.url+c.mainId+c.suffix+c.extension)}function e(b){var d="/"+b;return a.get(g.url+c.mainId+c.suffix+d+c.extension)}function f(a){return localforage.setItem("items",a).then(function(a){return localforage.getItem("items")})}var g={getRessources:d,getRessourcesItem:e,url:c.urlMain,save:f,storage:[]};return g}angular.module("barista",["ngRoute","ngTouch","angular-carousel","angular.filter","ngSanitize","com.2fdevs.videogular","com.2fdevs.videogular.plugins.controls","com.2fdevs.videogular.plugins.overlayplay","com.2fdevs.videogular.plugins.poster"]).config(["$routeProvider",function(a){a.when("/media/:id",{templateUrl:"views/item.html",controller:"ItemCtrl",controllerAs:"items"}).when("/",{templateUrl:"views/home.html",controller:"HomeCtrl",controllerAs:"main"}).otherwise({redirectTo:"/"})}]),function(){function a(a,b,c,d,e,f){var g=c.id,h=this;h.product={},h.display=!1,h.config={tracks:[{src:"http://www.videogular.com/assets/subs/pale-blue-dot.vtt",kind:"subtitles",srclang:"fr",label:"Français","default":""}],theme:"bower_components/videogular-themes-default/videogular.css"},h.play=function(){h.display=!h.display},h.back=function(){e.history.back()},f.getRessourcesItem(g).then(function(a){var b=a.data.entry;h.product.title=b.gsx$title.$t,h.product.img=b.gsx$img.$t,h.product.type=b.gsx$type.$t,h.product.director=b.gsx$director.$t,h.product.description=b.gsx$description.$t,h.product.trailer=b.gsx$trailer.$t,h.product.link=b.gsx$link.$t,h.product.category=b.gsx$category.$t,h.product.episode=b.gsx$episode.$t,h.config.sources=[{src:d.trustAsResourceUrl(b.gsx$link.$t),type:"video/webm; codecs=vp8, vorbis"},{src:d.trustAsResourceUrl(b.gsx$link.$t),type:"video/mp4"},{src:d.trustAsResourceUrl(b.gsx$link.$t),type:"video/ogg"}],h.config.plugins={poster:b.gsx$img.$t}},function(a){console.error(a)})}angular.module("barista").controller("ItemCtrl",["$scope","$http","$routeParams","$sce","$window","drive",a])}(),angular.module("barista").controller("HomeCtrl",["$http","$log","drive",HomeCtrl]),angular.module("barista").service("drive",["$http","$log","config",drive]),angular.module("barista").constant("config",{mainId:"13SOrx5_jlro0zNEXADBqzeMkdT7Nwp8xc954vZIKh64",extension:"?alt=json",urlMain:"https://spreadsheets.google.com/feeds/list/",suffix:"/od6/public/values"}),angular.module("app").run(["$templateCache",function(a){a.put("views/home.html",'<form class="search-form"> <label for="search">Rechercher</label> <input type="search" class="search-input" ng-model="search" autofocus name="search" id="search" placeholder="Films, Séries, Animés, ..."> </form> <ul class="search-result"> <li ng-repeat="item in main.list | filter: search" class="list-line"><a ng-href="#!/media/{{item.ressource}}" title="{{item.title}}"><span ng-bind="item.title" class="list-title"></span><span ng-bind="item.episode" class="list-episode"></span></a></li> </ul>'),a.put("views/item.html",'<div class="ariane"><a ng-click="items.back()" title="{{\'Retour\'}}">Retour</a> <span ng-bind="items.product.title"></span></div> <ul class="landing"> <li> <div class="media-img" style="background-image:url({{items.product.img}})"></div> <div class="carousel"> <span class="push" ng-bind="items.product.category"></span> <div class="denomination"> <h2 class="title">{{items.product.title}}</h2> <span class="year" ng-hide="items.product.category < 1">{{items.product.category}}</span> <span class="year" ng-hide="items.product.type < 1">{{items.product.type}}</span> <span class="director" ng-hide="items.product.director < 1">{{items.product.director}}</span> </div> <p class="description" ng-bind="items.product.description"></p> <div class="linkTrailer"> <a ng-href="{{items.product.trailer}}" class="trailer" ng-hide="items.product.trailer.length < 1"> ▸ Watch the trailer</a> <a ng-click="items.play()" class="hackit" ng-if="items.product.link">Hack it</a> <span ng-href="" class="soon" ng-if="!items.product.link">Coming soon</span> </div> <videogular vg-theme="items.config.theme" class="video-content-main" ng-show="items.display"> <vg-media vg-src="items.config.sources" vg-tracks="items.config.tracks"> </vg-media> <vg-controls> <vg-play-pause-button></vg-play-pause-button> <vg-time-display>{{ currentTime | date:\'mm:ss\' }}</vg-time-display> <vg-scrub-bar> <vg-scrub-bar-current-time></vg-scrub-bar-current-time> </vg-scrub-bar> <vg-time-display>{{ timeLeft | date:\'mm:ss\' }}</vg-time-display> <vg-volume> <vg-mute-button></vg-mute-button> <vg-volume-bar></vg-volume-bar> </vg-volume> <vg-fullscreen-button></vg-fullscreen-button> </vg-controls> <vg-overlay-play></vg-overlay-play> <vg-poster vg-url="items.config.plugins.poster"></vg-poster> </videogular> </div> </li> </ul>')}]);